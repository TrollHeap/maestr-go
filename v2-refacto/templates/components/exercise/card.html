{{define "exercise-card"}}
<div 
    class="exercise-card"
    style="--exercise-color: {{.Visual.ColorHex}}; border-left: 4px solid {{.Visual.ColorHex}};"
    hx-get="/exercise/{{.ID}}"
    hx-target="#main-content"
    hx-swap="innerHTML"
>
    <!-- Header avec signature visuelle -->
    <div class="exercise-header">
        <span class="exercise-icon">{{.Visual.IconEmoji}}</span>
        <div class="exercise-title-group">
            <h3 class="exercise-title">{{.Title}}</h3>
            <span class="exercise-domain" style="background: {{.Visual.ColorHex}};">
                {{.Domain}}
            </span>
        </div>
    </div>
    
    <!-- Mnemonic visible -->
    {{if .Visual.Mnemonic}}
    <div class="exercise-mnemonic">
        <span class="mnemonic-icon">ğŸ’¡</span>
        <span class="mnemonic-text">{{.Visual.Mnemonic}}</span>
    </div>
    {{end}}
    
    <!-- Description courte -->
    <p class="exercise-description">{{.Description}}</p>
    
    <!-- MÃ©tadonnÃ©es -->
    <div class="exercise-meta">
        <span class="difficulty">
            {{range $i := until .Difficulty}}â­{{end}}
        </span>
        <span class="srs-info">
            {{if .Done}}
                ğŸ“… RÃ©vision : {{formatDate .NextReviewAt}}
            {{else}}
                ğŸ†• Nouveau
            {{end}}
        </span>
    </div>
    
    <!-- âœ¨ FIX : ASCII diagram avec <details> correctement fermÃ© -->
    {{if .Visual.ASCIIDiagram}}
    <details class="exercise-diagram">
        <summary>ğŸ” Voir diagramme</summary>
        <pre class="ascii-art">{{.Visual.ASCIIDiagram}}</pre>
    </details>
    {{end}}
</div>
{{end}}
