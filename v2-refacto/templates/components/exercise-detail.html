{{define "exercise-detail"}}
<div class="exercise-detail">
    <!-- Header -->
    <div class="exercise-detail__header">
        <h2 class="exercise-detail__title">{{.Title}}</h2>
        <span class="badge badge--domain-{{.Domain | lower}} badge--md">
            {{.Domain}}
        </span>
    </div>

    <!-- Description -->
    <p class="exercise-detail__description">{{.Description}}</p>

    <!-- Badges métadonnées -->
    <div class="exercise-detail__badges">
        <span class="badge badge--difficulty-{{.Difficulty}} badge--md">
            D{{.Difficulty}}
        </span>
        
        <span class="badge badge--progress badge--md">
            {{len .CompletedSteps}}/{{len .Steps}} étapes
        </span>
        
    </div>

    <hr class="exercise-detail__divider">

    <!-- Section Étapes -->
    <div class="exercise-detail__steps">
        <h3 class="exercise-detail__section-title">
            [ ETAPES ] {{len .CompletedSteps}}/{{len .Steps}}
        </h3>
        
        <div id="steps-container">
            {{range $index, $step := .Steps}}
            {{$isCompleted := false}}
            {{range $.CompletedSteps}}
                {{if eq . $index}}{{$isCompleted = true}}{{end}}
            {{end}}
            
            <div class="exercise-detail__step {{if $isCompleted}}exercise-detail__step--completed{{end}}">
                <label class="exercise-detail__step-label">
                    <input 
                        type="checkbox" 
                        class="exercise-detail__step-checkbox"
                        hx-post="/exercise/{{$.ID}}/toggle-step?step={{$index}}"
                        hx-target="#exercise-detail"
                        hx-swap="innerHTML"
                        {{if $isCompleted}}checked{{end}}
                    >
                    
                    <span class="exercise-detail__step-number {{if $isCompleted}}exercise-detail__step-number--completed{{end}}">
                        {{add $index 1}}
                    </span>
                    
                    <span class="exercise-detail__step-text {{if $isCompleted}}exercise-detail__step-text--completed{{end}}">
                        {{$step}}
                    </span>
                </label>
            </div>
            {{end}}
        </div>
    </div>

    <hr class="exercise-detail__divider">

    <!-- Section Contenu -->
    <div>
        <h3 class="exercise-detail__section-title">[ CONTENU ]</h3>
        <div class="exercise-detail__content">{{.Content}}</div>
    </div>

</div>
{{end}}
